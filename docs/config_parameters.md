# Описание параметров файла config.plist

## Оглавление

[1. GUI](#1-gui)
* [1.1 TextOnly](#11-textonly)
* [1.2 ConsoleMode](#12-consolemode)
* [1.3 Theme](#13-theme)
* [1.4 EmbeddedThemeType](#14-embeddedthemetype)
* [1.5 Timezone](#15-timezone)
* [1.6 PlayAsync](#16-playasync)
* [1.7 CustomIcons](#17-customicons)
* [1.8 ScreenResolution](#18-screenresolution)
* [1.9 ProvideConsoleGop](#19-provideconsolegop)
* [1.10 KbdPrevLang](#110-kbdprevlang)

### 1. GUI

* **Описание**: Группа параметров, с помощью которых можно настроить вид загрузчика Clover.

//TODO: добавить пример кода со всеми параметрами из данной группы со значениями по умолчанию

#### 1.1 TextOnly

* **Тип значения**: `boolean`
* **Значение по умолчанию**: `false`
* **Возможные значения**: `false`, `true`
* **Описание**:

Данный параметр позволяет отображать интерфейс загрузчика в текстовом режиме. Если стоит `false`, то Clover работает в графическом режиме.
Разрешение текстового экрана, здесь, а также в Shell.efi и на экране boot.efi, можно установить с помощью параметра *ConsoleMode*.

* **Пример кода**:
```xml
<key>TextOnly</key>
<false/>
```

* **Пример результата применения**:

![textOnly example](./images/clover_textonly.png)

#### 1.2 ConsoleMode

* **Тип значения**: `string`
* **Значение по умолчанию**: `0`
* **Возможные значения**: `0`, `Min`, `Max`, `[number]`
* **Описание**:

Переключит драйвер консоли в требуемый режим консоли (который используется оболочкой, boot.efi, shell.efi, dumpueficalls и т.д.). Обычно в этом нет необходимости, и следует использовать только там, где это необходимо.

* **Пример кода**:
```xml
<key>ConsoleMode</key>
<string>0</string>
```

#### 1.3 Theme

* **Тип значения**: `string`
* **Значение по умолчанию**: `embedded`
* **Возможные значения**: `random`, `embedded`, `[text]`
* **Описание**:

Если вы не включили текстовый режим загрузчика Clover, то оформление графической оболочки будет зависеть от выбранной темы. Значение данного параметра это имя папки в `/CLOVER/themes`, которая содержит соответствующую структуру файлов.

//TODO: добавить ссылку на инструкцию по созданию темы и theme.plist

//TODO: добавить ссылку на информацию о контрольной панели

Тему можно выбрать в Контрольной панели Clover, и оно будет определяющим, в независимости от того, какая тема написана в config.plist. Если указана неправильная тема (в указанной папке нет файла theme.plist), то будет выбрана тема из config.plist. Если и там указана неверная тема, то будет отображаться встроенная `embedded` тема (последний вариант от Clovy). Так же, начиная с ревизии 1955 тему можно сменить и в самом загрузчике, перейдя в `Options -> GUI tuning -> Themes`. После выбора темы и перехода на начальный экран загрузчика, выбранная тема сразу применится и вид загрузчика изменится.

Тему можно скачать и установить вручную просто скачав архив с нужной темой, распаковав его в папку `/CLOVER/themes` и указав название папки с файлами темы параметре `Theme`. Официальный список и содержимое тем есть в [github](https://github.com/CloverHackyColor/CloverThemes) репозитории загрузчика (так же хранилище тем есть на [SourceForge](https://sourceforge.net/p/cloverefiboot/themes/ci/master/tree/themes/), но это устаревший вариант, т.к. он давно никем не обновляется) или в соответствующей теме форума [insanelymac](https://www.insanelymac.com/forum/topic/288685-clover-themes/). Так же есть приложения для удобного просмотра тем и их автоматической настройки - [Clover.app](https://www.insanelymac.com/forum/topic/341047-cloverapp-testing/) и [Clover Theme Manager](https://www.insanelymac.com/forum/topic/302674-clover-theme-manager/) (он вроде бы устарел).

Если вписать значение `random`, то при каждой загрузки в Clover будет использоваться случайная тема из тех, что находятся в `CLOVER/themes`.

Если ваш монитор имеет разрешение, например 2560х1600 или 4K, то
иконки и текст на экране будет слишком мелким. Чтобы это исправить, нужно использовать тему с более крупными значками и более крупным размером текста. Начиная с ревизии 4438 загрузчик Clover может самостоятельно на большом мониторе использовать крупную тему, а на маленьких - обычную тему. Крупная тема должна называться также, как и обычная, но с приставкой *@2x*. Например в параметре `Theme` указано значение `metal` и тогда для мониторов с небольшим разрешением Clover будет использовать файлы из папки `/CLOVER/themes/metal`, а для мониторов с большим разрешением Clover будет использовать файлы из папки `/CLOVER/themes/metal@2x`. Критерий "большого" монитора это количество пикселей больше 1100 по высоте.

Начиная с ревизии 4862 загрузчик Clover стал поддерживать масштабируемые, т.е. векторные темы. В векторных темах используется файл *theme.svg*, а в обычной растровой файл *theme.plist*. По наличию этих файлов Clover и отличает какая тема находится в папке.

* **Пример кода**:
```xml
<key>Theme</key>
<string>BGM</string>
```

#### 1.4 EmbeddedThemeType

* **Тип значения**: `string`
* **Значение по умолчанию**: `DayTime`
* **Возможные значения**: `DayTime`, `Dark`, `Light`
* **Описание**:

С помощью значений `Dark` и `Light` в данном параметре можно включить светлую или темную версию выбранной темы (конечно, если в теме присутствует светлая и темная версия). Если выбранная тема не сделана с учетом темной и светлой версии, то просто в любом случае будет отображаться единственный вариант этой темы. Данный параметр добавлен в ревизии 4644.

В ревизии 4773 добавлено значение `DayTime`. Если выбрано данное значение, то темная и светлая версия выбранной темы переключается в зависимости от времени суток. Clover включает светлую версию темы в промежутке от 8:00 до 20:00.

* **Пример кода**:
```xml
<key>EmbeddedThemeType</key>
<string>DayTime</string>
```

#### 1.5 Timezone

* **Тип значения**: `integer`
* **Значение по умолчанию**: `3`
* **Возможные значения**: `+3`, `-5`, `[number]`
* **Описание**:

Этот параметр актуально использовать только в паре с `EmbeddedThemeType` со значением `DayTime`. При запуске Clover считывает время из BIOS (оно обычно по Гринвичу) и прибавляет число из этого параметра и в сумме получается локальное время. Значения можно писать со знаком `+` или со знаком `-` или без знака (что равносильно знаку `+`). Параметр добавлен в ревизии 4773.

* **Пример кода**:
```xml
<key>Timezone</key>
<integer>3</integer>
```

#### 1.6 PlayAsync

* **Тип значения**: `boolean`
* **Значение по умолчанию**: `false`
* **Возможные значения**: `false`, `true`
* **Описание**:

В зависимости от значения в этом параметре, Clover определяет проигрывать звук синхронно со своей работой или асинхронно. При синхронном воспроизведении ничего не работает, пока звуковая дорожка не
закончится. При асинхронном звук играет независимо от действий, происходящих на экране. Звук начинает играть после появления на экране сообщения `...scan entries...` затем появляется интерфейс
Clover, воспроизведение звука продолжается, затем появляются строчки работы boot.efi, воспроизведение звука продолжается, затем запускается ядро, и по очереди запускаются кексты. Начиная с какого-то из них, воспроизведение звука обрывается. Ну это, разумеется, если аудиодорожка в файле *sound.wav* длинная.

Этот параметр добавлен в Clover в ревизии 4833 и он работает при наличии драйвера `AudioDxe.efi` (автор Goldfish64).

Clover ревизии 4862 имел баг и включенный параметр `PlayAsync` (именно со значением `true`) вызывал не давал правильно работать компьютеру. В ревизии 4870 этот баг исправили.

* **Пример кода**:
```xml
<key>PlayAsync</key>
<false/>
```

#### 1.7 CustomIcons

* **Тип значения**: `boolean`
* **Значение по умолчанию**: `false`
* **Возможные значения**: `false`, `true`
* **Описание**:

Этот параметр используется для отображения кастомных иконок у разделов диска. Если значение `true`, то для каждого раздела с операционной системой будет выполняться поиск иконки `.VolumeIcon.icns` в корне раздела и использоваться вместо иконок, заданных темой.

* **Пример кода**:
```xml
<key>CustomIcons</key>
<false/>
```

#### 1.8 ScreenResolution

* **Тип значения**: `string`
* **Значение по умолчанию**: `1280x1024`
* **Возможные значения**: `1280x1024`, `1920x1080`, `[text]`
* **Описание**:

Этот параметр позволяет установить разрешение экрана в меню загрузчика Clover. Clover пытается выставить наибольшее возможное разрешение, однако, он может ошибиться. Проверяйте список доступных режимов в boot.log.

Если в секции Graphics параметр `PatchVBios` имеет значение `true`, то у вас появится максимальное разрешение, доступное для данного монитора. В этом случае параметр `ScreenResolution` может оказаться лишним. С некоторыми конфигурациями параметр `PatchVBios` может быть фатальным - будет отображаться черный экран без признаков жизни.

При использовании данного параметра есть одна тонкость. Clover'у должен быть известен EDID монитора. Legacy Clover пытается его получить через вызовы INT10 BIOS, часто это успешно, иногда неуспешно. UEFI CLover запрашивает данные у UEFI BIOS, который наверняка знает EDID для встроенной видеокарты, и наверняка не знает для вставленной. Смотрите *preboot.log*, и если там нет EDID, то вписывайте его вручную.

//TODO: добавить ссылки на EDID и на PatchVBios

* **Пример кода**:
```xml
<key>ScreenResolution</key>
<string>1280x1024</string>
```

#### 1.9 ProvideConsoleGop

* **Тип значения**: `boolean`
* **Значение по умолчанию**: `true`
* **Возможные значения**: `true`, `false`
* **Описание**:

Этот параметр создает протокол GOP для режима консоли [ConsoleMode](#12-consolemode), то есть, чтобы вывод текста был не в текстовом режиме, как привыкли делать в PC BIOS, а в графическом, как это делает Apple.

В некоторых ревизиях Clover, этот параметр дублировался с квирком `ProvideConsoleGopEnable`, но начиная с ревизии 5128 этот параметр убран из списка квирков и есть только в разделе [GUI](#1-gui) с немного другим названием. Значение параметра `ProvideConsoleGop` из раздела [GUI](#1-gui) будет переопределять значение параметра `ProvideConsoleGopEnable` из списка квирков, если вдруг вы забыли убрать этот параметр из конфига при обновлении загрузчика.

Параметр лучше не выключать, нет адекватных аргументов в пользу его выключения.

* **Пример кода**:
```xml
<key>ProvideConsoleGop</key>
<true/>
```

#### 1.10 KbdPrevLang

* **Тип значения**: `boolean`
* **Значение по умолчанию**: `false`
* **Возможные значения**: `false`, `true`
* **Описание**:

Этот параметр используется для исправлению языковых проблем macOS при использовании нативного NVRAM. Этот баг macOS существует уже давно. Включите этот параметр (задайте значение `true`), если вы хотите сохранить язык системы при обновлении macOS с помощью встроенного NVRAM.

Этот параметр работает **только при использовании** `AptioMemoryFix` или `OsxAptioFixV3` без `EmuVariableuefi.efi`, т.е. нужен "железный" NVRAM. И также параметр работает при использовании языка, отличного от английского.

Рекомендуется всегда сохраняйте английский язык при обновлении macOS в режиме восстановления, несмотря на то, что пользователь уже использует другой язык в macOS.

Вы можете исправить проблемы ниже, используя этот ключ:
```xml
<key>GUI</key>
    <dict>
        <key>KbdPrevLang</key>
        <true/>
        <key>Language</key>
        <string>ru:0</string>          <----- you want language
    </dict>
```

* **Пример проявления проблемы**:

![KbdPrevLang пример проблемы](./images/clover_KbdPrevLang.png)

* **Пример кода**:
```xml
<key>ProvideConsoleGop</key>
<true/>
```